(function(){var b=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){return setTimeout(d,1);};}();var c=function(d){b(d);};function a(f,e,g,d){this.config=$.extend({attr:"data-lazyload",fade:false,loader:function(h,i){if(i||i.length<5){h.src=i;}},diff:-10,allowAuto:false},d);this.el=f;this.event=g;this.listenEl=e;this.bind();this.noCache=this.config.noCache||false;}a.queue=[];a.runQueue=function(){if(a.queue.length){var d=a.queue.shift();d();c(a.runQueue);}};a.prototype={load:function(f){var p=this;if(!this.el){return;}if(this.config.allowAuto&&window.imageSizeType=="none"){return;}this.loadEls=$("["+this.config.attr+"]",this.el).toArray();if(!this.loadEls.length){return;}var e=window.innerHeight;var o=this.iscroll?-this.iscroll.y:window.scrollY;for(var j=0,h;h=this.loadEls[j];j++){var n;var k=h.getBoundingClientRect();var m={top:k.top+o,bottom:k.bottom+o};n=m;var d=-Math.abs(this.config.diff),l=+Math.abs(this.config.diff);var g=!(n.top>e+o+l||n.bottom<o+d);if(g){p.config.loader(h,h.getAttribute(this.config.attr),p);if(p.config.fade){var q=$(h);q.css("opacity",0).on("load",function(){q.animate({opacity:1});});}h.removeAttribute(this.config.attr);}else{}}},bind:function(){var d=this;var e;$(this.listenEl).on(this.event,this.loadHandle=function(f){clearTimeout(e);e=setTimeout(function(){clearTimeout(e);d.load(f&&f.data);},100);});$(function(f){d.loadHandle(f);});},dispose:function(){$(this.listenEl).off(this.event,this.loadHandle);this.el=null;this.loadEls=null;}};a.tryLoadImg=function(e){var d=e.getAttribute("data-lazy");if(!d){return;}a.feedLoad(e,d);};a.feedLoad=function(e,d,i){var h=$(e);var g=new Image;var f=false;var j=Date.now();g.onload=function(){if(e.nodeName=="IMG"){e.src=d;}else{e.style.backgroundImage='url("'+d+'")';}h.addClass("loaded");g.onload=null;g=null;if(i.config.fade){h.css("opacity",0).on("load",function(){h.animate({opacity:1});});}};g.onerror=function(){e.setAttribute("img_on_error",d);h.addClass("failed");};g.src=d;};window.Lazy=a;})();
if(top.location.href!=window.location.href){top.location.href=window.location.href;}(function(){window.app={client:{ios:"http://www.365rili.com/temp/tj.html?url=https://itunes.apple.com/us/app/pu-tao/id1116047926?l=zh&ls=1&mt=8",android:"http://beta.qq.com/m/nlun"},open:function(f,j,k){var g;var i=function(){if(Object.prototype.toString.call(k)!="[object Function]"){if(app.getUa.weixin){if(app.getUa.ios){location.href="http://itunes.apple.com/cn/app/365ri-li-xin-ban/id642101382?ls=1&mt=8";}else{location.href="http://a.app.qq.com/o/simple.jsp?pkgname=com.when.coco&g_f=991609";}}else{if(app.getUa.ios){location.href="http://itunes.apple.com/cn/app/365ri-li-xin-ban/id642101382?ls=1&mt=8";}else{location.href="http://d2.365rili.com/coco.apk";}}}else{k();}};if(Object.prototype.toString.call(f)=="[object Object]"){if(app.getUa.ios){g=f.ios;}else{if(app.getUa.android){g=f.android;}}}else{g=f;}var e=function(){var l=document.createElement("iframe");l.style.display="none";l.src=g;document.body.appendChild(l);};if(app.getUa.weixin&&(function(){var n=navigator.userAgent.toLowerCase();var o=/\(iphone; cpu iphone os ([\d\_]*) like mac os x\)/;var m=n.match(o);if(m){var l=+m[1].split("_")[0];if(l>8){return false;}}return true;})()){app.getInstallStateInWeixin(function(){setTimeout(e,16);WeixinJSBridge.invoke("closeWindow",{},function(l){});},h);return false;}if(window.AliansBridge||app.getUa.coco){window.location.href=g;return false;}function h(){var m=new Date().getTime();e();var l=setTimeout(function(){var n=(new Date().getTime())-m;n<1020&&i();},1000);window.onblur=function(){l&&clearTimeout(l);};}h();},getInstallStateInWeixin:function(h,g){var f={};var e=function(){WeixinJSBridge.invoke("getInstallState",{packageUrl:"coco://",packageName:"com.when.coco"},function(i){if(i.err_msg.indexOf("get_install_state:yes")>-1){h&&h();f.state="yes";return f;}else{g&&g();f.state="no";return f;}});};if(typeof WeixinJSBridge==="undefined"){document.addEventListener("WeixinJSBridgeReady",e,false);f.state="notReady";return f;}else{e();}},call:function(g){var m=g.action||null;var h=g.callback||g.callBack||function(){};var l=g.params||[];if(!m){throw"没有调用的action";return false;}if(l&&Object.prototype.toString.call(l).toLowerCase()!="[object array]"){throw"参数集不是数组";return false;}if(app.getUa.ios){var k=["coco://365rili.com"];k.push("/"+m);var j="fn"+Math.ceil(app.random(1000000,9999999));window[j]=function(){if(window[j]._exec>0){return;}window[j]._exec++;h(arguments[0]);setTimeout(function(){delete window[j];for(var q=0;q<e.length;q++){delete window[e[q]];}},16);};window[j]._exec=0;k.push("?static="+j);var e=[];var f;for(var o=0;o<l.length;o++){f="p"+Math.ceil(app.random(1000000,9999999));window[f]=l[o]["value"];k.push("&"+l[o]["name"]+"="+f);e.push(f);}k=k.join("");window.location.href=k;}else{if(app.getUa.android){var p=[];for(var o=0;o<l.length;o++){p.push(l[o]["value"]);}var n=AliansBridge[m].apply(AliansBridge,p);h(n);}}},coco:(navigator.userAgent.toLowerCase().match(/vino/gi)||[""])[0],version:(function(){var g=(navigator.userAgent.toLowerCase().match(/(android|ios)-coco\|(.+)/gi)||[""])[0].split("|");if(g.length===1){return 0;}var e=g[2].split(".");for(var f=0;f<e.length;f++){e[f]||(e[f]=0);}return parseInt(e.join(""));})(),random:function(f,e){return Math.random()*(e-f)+f;},getUa:(function(){var h=navigator.userAgent.toLowerCase();var j=h.match(/ipad/i)=="ipad";var k=h.match(/iphone os/i)=="iphone os";var e=h.match(/android/i)=="android";var l=h.match(/micromessenger/i)=="micromessenger";var i=h.match(/weibo/i)=="weibo";var f=h.match(/qq/i)=="qq";var g=h.match(/ios-coco/i)=="ios-coco";var m=h.match(/android-coco/i)=="android-coco";return{ipad:j,iphone:k,android:e,weibo:i,weixin:l,qq:f,ios:k||j,iosCoco:g,androidCoco:m,coco:g||m};})(),query:d,_hm:function(){var e=document.createElement("script");switch(window.location.host){case"qq.365rili.com":e.src="//hm.baidu.com/hm.js?fa28bc85a1c9fdb279ad3129de90c4af";break;case"www.365rili.com":e.src="//hm.baidu.com/hm.js?ec877777cac7e868396078daa50bad6c";}document.getElementsByTagName("head")[0].appendChild(e);},TJ:{send:function(){if(location.hostname!=="qq.365rili.com"){return;}var m={};if(document){m.domain=document.domain||"";m.url=document.URL||"";m.title=document.title||"";m.referrer=document.referrer||"";}if(window&&window.screen){m.sh=window.screen.height||0;m.sw=window.screen.width||0;}if(navigator){var k=navigator.userAgent.toLowerCase();m.lang=navigator.language||"";m.bs=(function(){if(k==null){return"ie";}else{if(k.indexOf("chrome")!=-1){return"chrome";}else{if(k.indexOf("opera")!=-1){return"opera";}else{if(k.indexOf("msie")!=-1){return"ie";}else{if(k.indexOf("safari")!=-1){return"safari";}else{if(k.indexOf("firefox")!=-1){return"firefox";}else{if(k.indexOf("gecko")!=-1){return"gecko";}else{return"ie";}}}}}}}})();m.bsv=(function(){if(k==null){return"null";}else{if(k.indexOf("chrome")!=-1){return k.substring(k.indexOf("chrome")+7,k.length).split(" ")[0];}else{if(k.indexOf("opera")!=-1){return k.substring(k.indexOf("version")+8,k.length);}else{if(k.indexOf("msie")!=-1){return k.substring(k.indexOf("msie")+5,k.length-1).split(";")[0];}else{if(k.indexOf("safari")!=-1){return k.substring(k.indexOf("safari")+7,k.length);}else{if(k.indexOf("gecko")!=-1){return k.substring(k.indexOf("firefox")+8,k.length);}else{return"null";}}}}}}})();m.sys=(function f(){if(k.indexOf("nt 6.1")>-1){return"Windows 7";}else{if(k.indexOf("nt 6.0")>-1){return"Vista";}else{if(k.indexOf("nt 5.2")>-1){return"Windows xp";}else{if(k.indexOf("nt 5.1")>-1){return"Windows 2003";}else{if(k.indexOf("nt 5.0")>-1){return"Windows 2000";}else{if((k.indexOf("windows")!=-1||k.indexOf("win32")!=-1)){return"Windows";}else{if((k.indexOf("macintosh")!=-1||k.indexOf("mac os x")!=-1)){return"Mac";}else{if((k.indexOf("adobeair")!=-1)){return"Adobeair";}else{if((k.indexOf("linux")!=-1)){return"Linux";}else{return"Unknow";}}}}}}}}}})();m.d=(function(){if(k.match(/ipad/i)!=-1){return"ipad";}else{if(k.match(/iphone os/i)!=-1){return"iphone";}else{if(k.match(/midp/i)!=-1){return"midp";}else{if(k.match(/ucweb/i)!=-1){return"ucweb";}else{if(k.match(/android/i)!=-1){return"android";}else{if(k.match(/windows ce/i)!=-1){return"windows ce";}else{if(k.match(/windows mobile/i)!=-1){return"windows mobile";}else{return"pc";}}}}}}}})();}var l=window._maq;if(!l){l=window._maq=[];}for(var j=0,e=l.length;j<e;j++){switch(l[j][0]){case"_setAccount":m.account=l[j][1];break;case"_trackEvent":m.event=l[j].slice(1).join("|");default:break;}}l.length=0;window._maq.push=app.TJ.push;var h="";for(var j in m){if(h!=""){h+="&";}h+=j+"="+encodeURIComponent(m[j]);}var g=new Image(1,1);g.src="http://119.29.61.161/1.gif?"+h;setTimeout(function(){g.src="";},2000);},push:function(){window._map[0]=arguments[0];app.TJ.send();}},template:function(j,m,l,g){g=g||0;if(c(j)==="undefined"||c(m)==="undefined"){return"";}var f=[];l=l||{};if(c(m)==="array"){for(var h=0,e=m.length;h<e;h++){f.push(app.template(j,m[h],l,h));}}else{var k={};b(m,k);a(k,l);f.push(j.replace(/\{\$([^}]*)\}/g,function(q,n){var o=k,p=m;for(var r=0,s=n.split(".");r<s.length;r++){o=o?o[s[r]]:null;p=p?p[s[r]]:null;}return c(o)==="function"?o(p,m,k,g):(p||o||"");}));}return f.join("");},connectWebViewJavascriptBridge:function(e){if(window.WebViewJavascriptBridge){e(window.WebViewJavascriptBridge);}else{document.addEventListener("WebViewJavascriptBridgeReady",function(){e(window.WebViewJavascriptBridge);},false);}},needLogin:function(i,e,h,g){var f="";if(h){f=$.param(h);e=e.indexOf("?")>=0?e+"&"+f:e+"?"+f;}e=e?window.location.protocol+"//"+location.hostname+e:window.location.href;if(app.coco){app.connectWebViewJavascriptBridge(function(j){j.callHandler("signature",{url:e},function(k){if(k["x-vino-http-key"]){i(k,e);}else{j.callHandler("login",{back:g||window.location.href},function(){});}});});}else{if(app.GetCookie("auto-vino")){i({},e);}else{window.location.href="https://"+window.location.hostname+"/action/account/login.html?back="+(g?encodeURIComponent(g):"");}}},registForApp:function(e,f){if(app.coco){app.connectWebViewJavascriptBridge(function(g){g.registerHandler(e,f);});}else{window[e]=f;}},setCookie:function(g,i,e,l,h,k){var f=new Date();f.setTime(f.getTime());if(e){e=e*1000*60*60*24;}var j=new Date(f.getTime()+(e));document.cookie=g+"="+escape(i)+((e)?";expires="+j.toGMTString():"")+((l)?";path="+l:"")+((h)?";domain="+h:"")+((k)?";secure":"");},GetCookie:function(e){var j=null;if(document.cookie&&document.cookie!=""){var h=document.cookie.split(";");for(var g=0;g<h.length;g++){var f=h[g].replace(/^\s+|\s+$/g,"");if(f.substring(0,e.length+1)==(e+"=")){j=decodeURIComponent(f.substring(e.length+1));break;}}}return j;},footer:function(){function e(j){var k,h=j.href||"",f=j.datas||null,l=j.callback||function(){};var k=document.createElement("link");k.href=h+"?"+(new Date).getTime();k.rel="stylesheet";var g=function(){var n=false;try{if(k.sheet&&k.sheet.cssRules.length>0){n=true;}else{if(k.styleSheet&&k.styleSheet.cssText.length>0){n=true;}else{if(k.innerHTML&&k.innerHTML.length>0){n=true;}}}}catch(m){if(m.name&&m.name=="NS_ERROR_DOM_SECURITY_ERR"){n=true;}}if(i){clearInterval(i);l(f);}};$(k).appendTo("head");g();var i=setInterval(g,200);}e({href:"http://m.putaoputao.cn/css/footer.css",callback:function(){var f=$('<div class="___footer"><a href="javascript:;" class="footer_down_btn"><img src="/images/footerLogo.png" width="43" alt="" /><span>下载葡萄客户端，注册即享10元礼券！</span></a></div>');$("body").append(f);var g=$(".footer_down_btn");g.on("click",function(){if(app.getUa.ios){window.location.href=app.client.ios;}if(app.getUa.android){window.location.href=app.client.android;}});}});}};function b(h,g){for(var f in h){if(typeof f==="undefined"){continue;}if(typeof h[f]=="object"){g[f]={};if(h[f] instanceof Array){g[f]=[];}b(h[f],g[f]);continue;}g[f]=h[f];}}function a(g,f,k){if(k){a(g,k);}if(g&&f&&typeof f==="object"){var h,e;for(h in f){g[h]=f[h];}}return g;}function c(e){return/^\[object (.*)\]$/.exec(Object.prototype.toString.call(e).toLowerCase())[1];}function d(f,e){var g=new RegExp("(^|\\?|&)"+f+"=([^&^#]*)(\\s|&|#|$)","i");e=e||location.href;if(g.test(e)){return decodeURIComponent(RegExp.$2.replace(/\+/g," "));}return"";}if(app.coco){(function(){var e=document.createElement("iframe");e.style.display="none";e.src="wvjbscheme://__BRIDGE_LOADED__";document.documentElement.appendChild(e);setTimeout(function(){document.documentElement.removeChild(e);},1000);})();}app.TJ.send();if(app.GetCookie("needReload")){app.setCookie("needReload","1","-1","/");window.location.reload(true);}})();if(typeof $!=="undefined"){$(app._hm);}else{app._hm();}